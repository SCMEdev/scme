    program testdip
      use ps_dip, only: vibdip
      implicit none
      integer, parameter :: n = 2
      real*8 x(n,3,3), d(3)!, A2b, au2deb
      integer i,j
      real*8 , parameter :: A2b = 1.889725989d0 !Ångström to Bohr
      real*8 , parameter :: au2deb = 2.541746230211d0 !a.u. to debye
      !      x(n,xyz,HHO)
      
      
      

!      x(1,1,:) = [-1.502169d+00, -1.913590d-01,  1.434927d+00]*A2b ! O
!      x(1,2,:) = [-2.006698d+00, -4.223270d-01,  2.219847d+00]*A2b ! H
!      x(1,3,:) = [-6.010540d-01, -5.969720d-01,  1.553718d+00]*A2b ! H 
!      x(2,1,:) = [-1.744575d+00, -3.823480d-01, -1.309144d+00]*A2b ! O
!      x(2,2,:) = [-2.516835d+00, -7.667650d-01, -1.733766d+00]*A2b ! H
!      x(2,3,:) = [-1.888941d+00, -4.796530d-01, -3.476240d-01]*A2b ! H
!      x(3,1,:) = [-5.604090d-01,  2.017830d+00, -1.219840d-01]*A2b ! O
!      x(3,2,:) = [-9.898310d-01,  1.592736d+00, -8.774190d-01]*A2b ! H
!      x(3,3,:) = [-9.477200d-01,  1.533567d+00,  6.252280d-01]*A2b ! H
!      x(4,1,:) = [ 9.648030d-01, -1.165765d+00,  1.439987d+00]*A2b ! O
!      x(4,2,:) = [ 1.542224d+00, -3.936920d-01,  1.344373d+00]*A2b ! H
!      x(4,3,:) = [ 9.795570d-01, -1.522041d+00,  5.278330d-01]*A2b ! H
!      x(5,1,:) = [ 9.747050d-01, -1.401503d+00, -1.335970d+00]*A2b ! O
!      x(5,2,:) = [ 1.470709d+00, -5.709330d-01, -1.277710d+00]*A2b ! H
!      x(5,3,:) = [ 6.516100d-02, -1.118951d+00, -1.522886d+00]*A2b ! H
!      x(6,1,:) = [ 2.002280d+00,  1.057824d+00, -1.245020d-01]*A2b ! O
!      x(6,2,:) = [ 2.674716d+00,  1.735342d+00, -2.379950d-01]*A2b ! H
!      x(6,3,:) = [ 1.141637d+00,  1.532266d+00, -1.401210d-01]*A2b ! H

      x(1,1,:) = [  0.000,  0.000,  0.000]!*A2b ! O
      x(1,2,:) = [  0.018, -0.739,  0.521]!*A2b ! H
      x(1,3,:) = [ -0.815, -0.673, -0.592]!*A2b ! H 
      x(2,1,:) = [  1.675, -2.803,  0.911]!*A2b ! O
      x(2,2,:) = [  1.942, -1.964,  1.223]!*A2b ! H
      x(2,3,:) = [  2.319, -3.450,  1.136]!*A2b ! H


!    coordinates(1)  =  0.018       ! x H1 on W1
!    coordinates(2)  = -0.739       ! y H1 on W1
!    coordinates(3)  =  0.521       ! z H1 on W1
!    coordinates(4)  = -0.815       ! x H2 on W1
!    coordinates(5)  = -0.673
!    coordinates(6)  = -0.592
!    coordinates(7)  =  1.942       ! x H1 on W2
!    coordinates(8)  = -1.964       ! y H1 on W2
!    coordinates(9)  =  1.223       ! z H1 on W2
!    coordinates(10) =  2.319       ! x H2 on W2
!    coordinates(11) = -3.450
!    coordinates(12) =  1.136
!    coordinates(13) =  0.000       ! x O on W1
!    coordinates(14) =  0.000
!    coordinates(15) =  0.000
!    coordinates(16) =  1.675       ! x O on W2
!    coordinates(17) = -2.803
!    coordinates(18) =  0.911

      do i = 1,n
          call vibdip(x(i,:,:),d)
          print*, sqrt(sum(d(:)**2))*au2deb
          print*, d(:)*au2deb
      enddo
    end program 










!      x(1,:,1) =  [-2.006698d+00,  -4.223270d-01,   2.219847d+00]*A2b !H 
!      x(1,:,2) =  [-6.010540d-01,  -5.969720d-01,   1.553718d+00]*A2b !H 
!      x(1,:,3) =  [-1.502169d+00,  -1.913590d-01,   1.434927d+00]*A2b !O  
!      x(2,:,1) =  [-2.516835d+00,  -7.667650d-01,  -1.733766d+00]*A2b !H 
!      x(2,:,2) =  [-1.888941d+00,  -4.796530d-01,  -3.476240d-01]*A2b !H 
!      x(2,:,3) =  [-1.744575d+00,  -3.823480d-01,  -1.309144d+00]*A2b !O 
!      x(3,:,1) =  [-9.898310d-01,   1.592736d+00,  -8.774190d-01]*A2b !H 
!      x(3,:,2) =  [-9.477200d-01,   1.533567d+00,   6.252280d-01]*A2b !H 
!      x(3,:,3) =  [-5.604090d-01,   2.017830d+00,  -1.219840d-01]*A2b !O 
!      x(4,:,1) =  [ 1.542224d+00,  -3.936920d-01,   1.344373d+00]*A2b !H 
!      x(4,:,2) =  [ 9.795570d-01,  -1.522041d+00,   5.278330d-01]*A2b !H 
!      x(4,:,3) =  [ 9.648030d-01,  -1.165765d+00,   1.439987d+00]*A2b !O 
!      x(5,:,1) =  [ 1.470709d+00,  -5.709330d-01,  -1.277710d+00]*A2b !H 
!      x(5,:,2) =  [ 6.516100d-02,  -1.118951d+00,  -1.522886d+00]*A2b !H 
!      x(5,:,3) =  [ 9.747050d-01,  -1.401503d+00,  -1.335970d+00]*A2b !O 
!      x(6,:,1) =  [ 2.674716d+00,   1.735342d+00,  -2.379950d-01]*A2b !H 
!      x(6,:,2) =  [ 1.141637d+00,   1.532266d+00,  -1.401210d-01]*A2b !H 
!      x(6,:,3) =  [ 2.002280d+00,   1.057824d+00,  -1.245020d-01]*A2b !O 


!6mer.xyz
!O      -1.502169000e+00  -1.913590000e-01   1.434927000e+00
!H      -2.006698000e+00  -4.223270000e-01   2.219847000e+00
!H      -6.010540000e-01  -5.969720000e-01   1.553718000e+00
!O      -1.744575000e+00  -3.823480000e-01  -1.309144000e+00
!H      -2.516835000e+00  -7.667650000e-01  -1.733766000e+00
!H      -1.888941000e+00  -4.796530000e-01  -3.476240000e-01
!O      -5.604090000e-01   2.017830000e+00  -1.219840000e-01
!H      -9.898310000e-01   1.592736000e+00  -8.774190000e-01
!H      -9.477200000e-01   1.533567000e+00   6.252280000e-01
!O       9.648030000e-01  -1.165765000e+00   1.439987000e+00
!H       1.542224000e+00  -3.936920000e-01   1.344373000e+00
!H       9.795570000e-01  -1.522041000e+00   5.278330000e-01
!O       9.747050000e-01  -1.401503000e+00  -1.335970000e+00
!H       1.470709000e+00  -5.709330000e-01  -1.277710000e+00
!H       6.516100000e-02  -1.118951000e+00  -1.522886000e+00
!O       2.002280000e+00   1.057824000e+00  -1.245020000e-01
!H       2.674716000e+00   1.735342000e+00  -2.379950000e-01
!H       1.141637000e+00   1.532266000e+00  -1.401210000e-01
      
